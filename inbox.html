<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Qinghe Mail · 私人邮箱</title>
<link rel="stylesheet" href="css/style.css"/>
<script src="js/main.js" defer></script>
<script src="js/auth.js" defer></script>
<script src="js/inbox.js" defer></script>
<style>
  body{ background:#0b0f16; }
  .mail-app{ max-width:1200px; margin:18px auto; border:1px solid #202a3a; border-radius:14px; overflow:hidden; background:#0f1520; box-shadow:0 12px 28px rgba(0,0,0,.35)}
  .mail-top{ padding:12px 16px; display:flex; align-items:center; justify-content:space-between; background:#0e1522; border-bottom:1px solid #1c2636 }
  .mail-top .brand{ display:flex; align-items:center; gap:10px; color:#e7ebf3; font-weight:700 }
  .mail-top .brand .logo{ width:26px;height:26px;border-radius:6px;background:#12223a;border:1px solid #274269 }
  .mail-top .actions{ display:flex; gap:8px; align-items:center }
  .mail-top .actions .btn-link{ color:#aeb7c6; font-size:12px; }
  .mail-layout{ display:grid; grid-template-columns:240px 360px 1fr; min-height:68vh }
  /* 文件夹栏 */
  .folders{ border-right:1px solid #1c2636; background:#0d1320; padding:10px }
  .folders h4{ margin:6px 8px 10px; color:#aeb7c6; font-size:12px; letter-spacing:.5px }
  .folders a{ display:flex; align-items:center; justify-content:space-between; color:#dfe6f1; padding:10px 12px; border-radius:10px; text-decoration:none }
  .folders a.active,.folders a:hover{ background:#111a2b; border:1px solid #25406a }
  .folders .badge{ background:#274b7b; border:1px solid #355f9e; border-radius:999px; padding:0 7px; font-size:12px }
  /* 列表栏 */
  .list{ border-right:1px solid #1c2636; background:#0d1422; overflow:auto }
  .list .tools{ padding:8px 10px; border-bottom:1px solid #1c2636; display:flex; gap:8px }
  .list .tools .input{ width:100% }
  .mail-row{ display:grid; grid-template-columns:22px 1fr 108px; gap:8px; padding:10px 12px; border-bottom:1px dashed #1f2a3f; cursor:pointer }
  .mail-row:hover{ background:#101a2c }
  .mail-row.unread{ background:#686767 }
  .mail-row .from{ color:#cfd8e7 }
  .mail-row .subject{ color:#e9edf6; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .mail-row .date{ color:#8f98a6; font-size:12px; justify-self:end }
  .star{ width:18px; height:18px; border:1px solid #2a3b58; border-radius:4px; display:inline-flex; align-items:center; justify-content:center; }
  .star.on{ background:#284a7c; }
  /* 阅读区 */
  .read{ background:#0f1728; overflow:auto }
  .read .hd{ padding:14px 16px; border-bottom:1px solid #1c2636; display:flex; justify-content:space-between; align-items:center }
  .read .title{ font-weight:700; color:#e6ebf5; }
  .read .meta{ color:#b6a79a; font-size:12px; padding:0 16px 12px; border-bottom:1px solid #1c2636 }
  .read .content{ padding:14px 16px; line-height:1.7; color:#dbe2ee; white-space:pre-wrap }
  .read .bar{ display:flex; gap:8px }
  .ghost{ color:#aeb7c6; font-size:12px }
  /* 未登录遮罩 */
  #mailLoginCover{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:9999 }
  #mailLoginCover .box{ width:420px; background:#141b2a; border:1px solid #223048; border-radius:12px; padding:16px; color:#e8eef8 }
  #mailLoginCover .box .muted{ color:#9aa7b7; font-size:12px }
</style>
</head>
<body>
<script>
  document.addEventListener('DOMContentLoaded', function(){
    if (typeof getAuth !== 'function') return;
    const a = getAuth();
    if (!a || a.id !== 'U-LL') return;

    const container = document.querySelector('.container');
    if (!container) return;
    if (document.getElementById('frozenBanner')) return;

    const div = document.createElement('div');
    div.id = 'frozenBanner';
    div.className = 'card';
    div.style.marginTop = '14px';
    div.innerHTML = `
      <p class="small" style="margin:0;">
        当前为 <span style="color:#f5c96a;font-weight:600;">封存账号的只读视图</span>，
        部分操作（修改、删除、回复邮件等）已被关闭，仅供家属核查学习与奖助记录之用。
      </p>
    `;
    container.insertBefore(div, container.firstChild);
  });
</script>

<div class="mail-app">
  <div class="mail-top">
    <div class="brand"><div class="logo"></div>Qinghe Mail</div>
    <div class="actions">
      <button class="btn" id="btnBack">返回</button>
      <a class="btn" href="index.html">首页</a>
      <span class="btn-link">已登录：<span id="mailUser">未登录</span></span>
    </div>
  </div>

  <div class="mail-layout">
    <!-- 左：文件夹 -->
    <aside class="folders">
      <h4>文件夹</h4>
      <nav id="mailFolders">
        <a href="#" data-folder="inbox" class="active">收件箱 <span class="badge" id="badgeInbox">0</span></a>
        <a href="#" data-folder="star">星标</a>
        <a href="#" data-folder="read">已读</a>
        <a href="#" data-folder="sent">已发送</a>
      </nav>
    </aside>

    <!-- 中：列表 -->
    <section class="list">
      <div class="tools">
        <input class="input" id="kw" placeholder="搜索：主题 / 发件人"/>
        <button class="btn" id="btnRefresh">刷新</button>
      </div>
      <div id="mailList"></div>
    </section>

    <!-- 右：阅读区 -->
    <section class="read" id="readPane">
      <div class="hd">
        <div class="title">选择邮件以阅读</div>
        <div class="bar">
          <button class="btn" id="btnToggleRead">标为已读</button>
          <button class="btn" id="btnToggleStar">加星标</button>
        </div>
      </div>
      <div class="meta">发件人：—　时间：—</div>
      <div class="content">右侧阅读区将展示所选邮件的内容。</div>
    </section>
  </div>
</div>

<!-- 未登录引导层（仅在未登录时显示） -->
<div id="mailLoginCover">
  <div class="box">
    <h3 style="margin:0 0 8px">登录 Qinghe Mail</h3>
    <p class="muted">请先登录校园账号后查看私人邮箱。</p>
    <p class="muted">示例：林镜 <code>linjing@stu.qh.edu</code> 　密码 <code>qh-2025</code></p>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
      <a class="btn" href="index.html">返回首页</a>
      <button class="btn primary" id="mailGoLogin">账号登录</button>
    </div>
  </div>
</div>

</body>
</html>
